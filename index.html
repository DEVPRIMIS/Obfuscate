<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Centre de Cryptage ‚Äì PrimisTool</title>
  <script src="https://cdn.jsdelivr.net/npm/javascript-obfuscator/dist/index.browser.js"></script>
  <style>
    body {
      margin: 0;
      padding: 1rem;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0f0f0f;
      color: #f1f1f1;
    }
    h1 {
      text-align: center;
      margin-bottom: 2rem;
      font-size: 1.6rem;
    }
    .section {
      background-color: #1e1e1e;
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 2rem;
      box-shadow: 0 0 10px rgba(0,0,0,0.4);
    }
    .section h2 {
      font-size: 1.2rem;
      margin-bottom: 1rem;
      color: #4caf50;
    }
    input[type="file"], input[type="text"], button, textarea, a {
      width: 100%;
      margin-top: 0.5rem;
      margin-bottom: 1rem;
      font-size: 1rem;
      padding: 0.75rem;
      border-radius: 8px;
      border: none;
      box-sizing: border-box;
    }
    input[type="text"] {
      background-color: #111;
      color: #fff;
    }
    button {
      background-color: #4caf50;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover {
      background-color: #3e9143;
    }
    textarea {
      background-color: #111;
      color: #0f0;
      font-family: monospace;
      height: 200px;
      resize: vertical;
    }
    a {
      background-color: #2196f3;
      text-align: center;
      color: white;
      text-decoration: none;
      display: none;
    }
    a:hover {
      background-color: #1976d2;
    }
  </style>
</head>
<body>

<h1>üîê Centre de Cryptage ‚Äì PrimisTool</h1>

<div class="section" id="jsSection">
  <h2>üîí Cryptage JavaScript (standard)</h2>
  <input type="file" accept=".js" onchange="handleFile(this, 'js')" />
  <button onclick="process('js', false)">Crypter JavaScript</button>
  <textarea id="output-js" readonly placeholder="R√©sultat JavaScript ici..."></textarea>
  <a id="download-js" download="fichier_crypte.js">‚¨áÔ∏è T√©l√©charger</a>
</div>

<div class="section" id="jsNameSection">
  <h2>üß† Cryptage JavaScript avec nom personnalis√©</h2>
  <input type="file" accept=".js" onchange="handleFile(this, 'jsname')" />
  <input type="text" id="customName" placeholder="Entrez un nom personnalis√© (ex: Primis)" />
  <button onclick="process('jsname', true)">Crypter avec Nom</button>
  <textarea id="output-jsname" readonly placeholder="R√©sultat crypt√© avec nom ici..."></textarea>
  <a id="download-jsname" download="fichier_crypte_personnalise.js">‚¨áÔ∏è T√©l√©charger</a>
</div>

<!-- HTML, CSS, JSON minifiers (inchang√©s) -->
<div class="section" id="htmlSection">
  <h2>üìÑ Minifier HTML</h2>
  <input type="file" accept=".html" onchange="handleFile(this, 'html')" />
  <button onclick="process('html')">Minifier HTML</button>
  <textarea id="output-html" readonly placeholder="R√©sultat HTML ici..."></textarea>
  <a id="download-html" download="fichier_minifie.html">‚¨áÔ∏è T√©l√©charger</a>
</div>

<div class="section" id="cssSection">
  <h2>üé® Minifier CSS</h2>
  <input type="file" accept=".css" onchange="handleFile(this, 'css')" />
  <button onclick="process('css')">Minifier CSS</button>
  <textarea id="output-css" readonly placeholder="R√©sultat CSS ici..."></textarea>
  <a id="download-css" download="fichier_minifie.css">‚¨áÔ∏è T√©l√©charger</a>
</div>

<div class="section" id="jsonSection">
  <h2>üì¶ Minifier JSON</h2>
  <input type="file" accept=".json" onchange="handleFile(this, 'json')" />
  <button onclick="process('json')">Minifier JSON</button>
  <textarea id="output-json" readonly placeholder="R√©sultat JSON ici..."></textarea>
  <a id="download-json" download="fichier_minifie.json">‚¨áÔ∏è T√©l√©charger</a>
</div>

<script>
  const fileContents = {};

  function handleFile(input, type) {
    const reader = new FileReader();
    const file = input.files[0];
    if (!file) return;

    reader.onload = e => fileContents[type] = e.target.result;
    reader.readAsText(file);
  }

  function process(type, withName = false) {
    const code = fileContents[type];
    if (!code) {
      alert("üìÑ Veuillez d'abord s√©lectionner un fichier.");
      return;
    }

    let result = "";

    if (type === 'js' || type === 'jsname') {
      let obfuscationOptions = {
        compact: true,
        controlFlowFlattening: true,
        controlFlowFlatteningThreshold: 0.75,
        deadCodeInjection: true,
        deadCodeInjectionThreshold: 0.4,
        disableConsoleOutput: true,
        identifierNamesGenerator: 'hexadecimal',
        renameGlobals: true,
        stringArray: true,
        stringArrayEncoding: ['base64'],
        stringArrayThreshold: 0.75
      };

      if (withName) {
        const nameInput = document.getElementById('customName').value.trim() || 'Primis';
        const cleanName = nameInput.replace(/[^a-zA-Z0-9]/g, '');
        const prefix = `Á¥†Êô¥Â∫ßÁ¥†${cleanName}Êô¥Â∫ßÁ¥†Á¥†Â∫ßÁ¥†Êô¥${cleanName}Á¥†Â∫ßÁ¥†`;

        obfuscationOptions = {
          ...obfuscationOptions,
          identifierNamesGenerator: 'mangled',
          identifiersPrefix: prefix
        };
      }

      const obfuscation = JavaScriptObfuscator.obfuscate(code, obfuscationOptions);
      result = obfuscation.getObfuscatedCode();
    } else {
      result = code.replace(/\n/g, '').replace(/\s{2,}/g, ' ').trim();
    }

    const output = document.getElementById(`output-${type}`);
    const download = document.getElementById(`download-${type}`);

    output.value = result;

    const blob = new Blob([result], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    download.href = url;
    download.style.display = 'block';
  }
</script>

</body>
</html> 
